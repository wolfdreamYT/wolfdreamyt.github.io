<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Security â€” Wolf Studios</title>
  <link rel="icon" href="icon.ico" type="image/x-icon">
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-neutral-900 text-slate-100 antialiased">

  <header class="max-w-7xl mx-auto px-6 py-6 flex items-center justify-between">
    <div class="flex items-center gap-4">
      <div class="w-10 h-10 rounded-lg"><img src="logo.png" alt="Logo"></div>
      <div>
        <div class="font-semibold text-lg">Wolf Studios</div>
        <div class="text-xs text-slate-400 -mt-0.5">Inventing products like animals.</div>
      </div>
    </div>
    <nav class="hidden md:flex gap-6 items-center text-slate-300">
      <a href="index.html" class="hover:text-white">Home</a>
      <a href="archon.html" class="hover:text-white">Genres</a>
    </nav>
  </header>

  <main class="max-w-7xl mx-auto px-6 py-12">
    <h1 class="text-4xl font-bold mb-8 text-center">Security</h1>

    <div id="newsGrid" class="grid grid-cols-1 md:grid-cols-2 gap-8"></div>

  </main>

  <script>
    function toggleCardContent(cardHeader) {
      const content = cardHeader.nextElementSibling;
      if (!content) return;

      if (content.style.maxHeight && content.style.maxHeight !== "0px") {
        content.style.maxHeight = "0px";
      } else {
        content.style.maxHeight = content.scrollHeight + "px";
      }
    }
  </script>
  <script>
    const GUARDIAN_API_KEY = "122c566f-8bd3-4e24-833a-afbd960d3e7d";

    async function loadSecurityNews() {
      const url = new URL("https://content.guardianapis.com/search");
      url.search = new URLSearchParams({
        section: "technology",      // Only technology section
        "show-fields": "trailText", // Give us previews
        "page-size": "30",           // Fetch more to filter
        "order-by": "newest",
        "api-key": GUARDIAN_API_KEY
      });

      try {
        const res = await fetch(url.toString());
        const data = await res.json();

        const grid = document.getElementById("newsGrid");
        grid.innerHTML = "";

        const results = data.response?.results || [];

        // Client-side filter: only security/cyber/privacy/hacking articles
        const filtered = results.filter(article => {
          const title = article.webTitle?.toLowerCase() || "";
          const preview = article.fields?.trailText?.toLowerCase() || "";

          return (
            title.includes("security") ||
            preview.includes("security") ||
            title.includes("cyber") ||
            preview.includes("cyber") ||
            title.includes("privacy") ||
            preview.includes("privacy") ||
            title.includes("hacking") ||
            preview.includes("hacking")
          );
        });

        if (filtered.length === 0) {
          grid.innerHTML =
            "<p class='text-slate-400'>No security articles found. Hackers must be sleeping.</p>";
          return;
        }

        filtered.slice(0, 8).forEach(article => {
          const card = document.createElement("a");
          card.href = article.webUrl;
          card.target = "_blank";
          card.rel = "noopener noreferrer";

          card.className =
            "block bg-slate-800/60 border border-slate-700 rounded-2xl p-6 transition hover:bg-slate-700 hover:shadow-lg";

          card.innerHTML = `
            <div class="text-2xl font-semibold line-clamp-2">
              ${article.webTitle}
            </div>
            <div class="mt-2 text-slate-400 text-sm line-clamp-3">
              ${article.fields?.trailText || ""}
            </div>
          `;

          grid.appendChild(card);
        });

      } catch (err) {
        console.error("Guardian API error:", err);
        document.getElementById("newsGrid").innerHTML =
          "<p class='text-red-400'>Failed to load security news. Firewall strike?</p>";
      }
    }

    // Load immediately
    loadSecurityNews();
  </script>

</body>
</html>
