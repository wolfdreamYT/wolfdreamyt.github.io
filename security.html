<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Security â€” Wolf Studios</title>
  <link rel="icon" href="icon.ico" type="image/x-icon">
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-neutral-900 text-slate-100 antialiased">

  <header class="max-w-7xl mx-auto px-6 py-6 flex items-center justify-between">
    <div class="flex items-center gap-4">
      <div class="w-10 h-10 rounded-lg"><img src="logo.png" alt="Logo"></div>
      <div>
        <div class="font-semibold text-lg">Wolf Studios</div>
        <div class="text-xs text-slate-400 -mt-0.5">Inventing products like animals.</div>
      </div>
    </div>
    <nav class="hidden md:flex gap-6 items-center text-slate-300">
      <a href="index.html" class="hover:text-white">Home</a>
      <a href="archon.html" class="hover:text-white">Genres</a>
    </nav>
  </header>

  <main class="max-w-7xl mx-auto px-6 py-12">
    <h1 class="text-4xl font-bold mb-8 text-center">Security</h1>

    <div id="newsGrid" class="grid grid-cols-1 md:grid-cols-2 gap-8"></div>

  </main>

  <script>
    function toggleCardContent(cardHeader) {
      const content = cardHeader.nextElementSibling;
      if (!content) return;

      if (content.style.maxHeight && content.style.maxHeight !== "0px") {
        content.style.maxHeight = "0px";
      } else {
        content.style.maxHeight = content.scrollHeight + "px";
      }
    }
  </script>
  <script>
    // ðŸ”‘ Put your API keys here:
    const KEYS = {
      NEWSDATA: "pub_dfb204a246df41acaad60b40b2e6e3dd",
      THENEWSAPI: "Pu6qA4WinfdF9qc4QyZWCSWOxzwsNhDSKQ4CUPC2",
      WORLDNEWS: "fa92c4471dbe4d94b9425cbc45efe10d",
      GNEWS: "1db657f5f8855a37be41936443abe22d",
      GUARDIAN: "122c566f-8bd3-4e24-833a-afbd960d3e7d"
    };

    // Each fetcher returns an array of articles with
    // { title, url, desc, source, published }
    async function fetchFromNewsData() {
      try {
        const res = await fetch(
          `https://newsdata.io/api/1/news?apikey=${KEYS.NEWSDATA}&q=security&language=en`
        );
        const json = await res.json();
        return (json.results || []).map(a => ({
          title: a.title,
          url: a.link || a.url,
          desc: a.description || "",
          source: a.source_id,
          published: a.pubDate
        }));
      } catch {
        return [];
      }
    }

    async function fetchFromTheNewsAPI() {
      try {
        const res = await fetch(
          `https://api.thenewsapi.com/v1/news/all?api_token=${KEYS.THENEWSAPI}&search=security&language=en`
        );
        const json = await res.json();
        return (json.data || []).map(a => ({
          title: a.title,
          url: a.url,
          desc: a.description,
          source: a.source,
          published: a.published_at
        }));
      } catch {
        return [];
      }
    }

    async function fetchFromWorldNews() {
      try {
        const res = await fetch(
          `https://api.worldnewsapi.com/search-news?api-key=${KEYS.WORLDNEWS}&text=security`
        );
        const json = await res.json();
        return (json.articles || []).map(a => ({
          title: a.title,
          url: a.url,
          desc: a.description,
          source: a.source || "",
          published: a.publishedAt || a.published_at
        }));
      } catch {
        return [];
      }
    }

    async function fetchFromGNews() {
      try {
        const res = await fetch(
          `https://gnews.io/api/v4/search?q=security&lang=en&apikey=${KEYS.GNEWS}`
        );
        const json = await res.json();
        return (json.articles || []).map(a => ({
          title: a.title,
          url: a.url,
          desc: a.description,
          source: a.source.name,
          published: a.publishedAt
        }));
      } catch {
        return [];
      }
    }

    async function fetchFromGuardian() {
      try {
        const url = new URL("https://content.guardianapis.com/search");
        url.search = new URLSearchParams({
          q: "security OR cyber OR privacy OR hacking",
          "show-fields": "trailText",
          "page-size": "20",
          "order-by": "newest",
          "api-key": KEYS.GUARDIAN
        });
        const res = await fetch(url.toString());
        const data = await res.json();
        return (data.response?.results || []).map(a => ({
          title: a.webTitle,
          url: a.webUrl,
          desc: a.fields?.trailText || "",
          source: "Guardian",
          published: a.webPublicationDate
        }));
      } catch {
        return [];
      }
    }

    // Unified render
    async function renderSecurityNews() {
      const grid = document.getElementById("newsGrid");
      grid.innerHTML = "";

      const all = await Promise.all([
        fetchFromNewsData(),
        fetchFromTheNewsAPI(),
        fetchFromWorldNews(),
        fetchFromGNews(),
        fetchFromGuardian()
      ]).then(results => results.flat());

      // Dedupe by URL
      const seen = new Set();
      const filtered = all.filter(a => {
        if (!a.url || seen.has(a.url)) return false;
        seen.add(a.url);
        return (
          a.title.toLowerCase().includes("security") ||
          a.desc.toLowerCase().includes("security")
        );
      });

      if (filtered.length === 0) {
        grid.innerHTML =
          "<p class='text-slate-400 text-center'>No security news found ðŸ˜•</p>";
        return;
      }

      filtered.slice(0, 16).forEach(article => {
        const card = document.createElement("a");
        card.href = article.url;
        card.target = "_blank";
        card.rel = "noopener";

        card.className =
          "block bg-slate-800/60 border border-slate-700 rounded-2xl p-6 mb-4 transition hover:bg-slate-700 hover:shadow-lg";

        card.innerHTML = `
          <div class="text-2xl font-semibold line-clamp-2">${article.title}</div>
          <div class="mt-2 text-slate-400 text-sm line-clamp-3">${article.desc || ""}</div>
          <div class="mt-3 text-xs text-slate-500">${article.source} â€¢ ${
          article.published
            ? new Date(article.published).toLocaleDateString()
            : ""
        }</div>
        `;
        grid.appendChild(card);
      });
    }

    renderSecurityNews();
  </script>


</body>
</html>
